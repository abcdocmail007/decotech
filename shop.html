<script>
    async function loadAllProducts() {
        try {
            // আপনার লাইভ এপিআই লিঙ্ক
            const res = await fetch('https://decotech-api.onrender.com/api/products');
            const products = await res.json();

            const container = document.getElementById('shopProductList'); // আপনার HTML এর ID অনুযায়ী ঠিক করে নিন
            
            if (products.length === 0) {
                container.innerHTML = '<p>বর্তমানে কোনো প্রোডাক্ট নেই।</p>';
                return;
            }

            container.innerHTML = products.map(p => `
                <div class="product-card">
                    <img src="${p.image || p.imageUrl}" alt="${p.name}">
                    <h3>${p.name}</h3>
                    <p class="category">${p.category}</p>
                    <p class="price">৳ ${p.price}</p>
                    <button onclick="addToCart('${p.name}', ${p.price}, '${p.image || p.imageUrl}')">Add to Cart</button>
                </div>
            `).join('');

        } catch (err) {
            console.error("Error loading products:", err);
            document.getElementById('shopProductList').innerHTML = '<p>প্রোডাক্ট লোড করতে সমস্যা হয়েছে।</p>';
        }
    }

    // পেজ লোড হলে কল হবে
    loadAllProducts();

    function addToCart(name, price, image) {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let existingItem = cart.find(item => item.name === name);
        
        if (existingItem) {
            existingItem.quantity += 1;
        } else {
            // নিশ্চিত করুন যে প্রাইসটি নাম্বার হিসেবে যাচ্ছে
            cart.push({ name, price: Number(price), image, quantity: 1 });
        }
        
        localStorage.setItem('cart', JSON.stringify(cart));
        alert(name + " কার্টে যোগ হয়েছে!");
    }
</script>
